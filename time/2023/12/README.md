# 2023.12.1 周五
- [x] 把相关超参数全部调成初始值，再做实验，看是不是过拟合，不管是什么原因的过拟合。
> 我拿初始的epoch 1进行test，结果为11多，看来还是模型代码的问题。


- [x] 除了调参以外，还可以把计算loss的过程改为把预测值旋转平移到世界坐标系，与真值求欧氏距离。  
> 不肯是旋转平移的问题了，因为我拿test代码跑了val的，没有问题，直接看散点图都没问题。


- [ ] Risk Assessment 帖子推荐的第一篇论文是讲AV的风险评估(RA)的，重点看看。
> 风险评估方法

- [x] 昨晚突然想出来的法子，test集没有真值，我拿val集走一遍test代码，拿结果对比一下。
> 为了方便，首先把test_obs和val文件名相互替换。  
> test代码好像不管其他的数据，直接拉了val前1000数据过来当test的some，把结果存到test的some_result里面，最后发现，预测效果很好，效果好不是假的。  
> 那就真见鬼了，除非我拿val集训练了，不然这也太怪了。又看了一下，val代码连loss都没有输出，怎么可能训练了。  
> 那，到底是为什么呢？  
> 我发现一个特征，val数据跑出来的数据，Excel可以一下子识别出来散点图，但test就识别不出来，反正就是val什么都是好的，test啥啥不行，**是不是test的编码有问题啊**，没有兼容。  
> 或者说，完整轨迹就是OK的，不完整轨迹就是有问题。

- [x] test数据的编码过程有没有问题？
> test又分了几个文件夹  
> some_val, some_test 分别存了val和test前一千个场景  
> some_qcnet_val, some_qcnet_test分别是其编码信息，  
> some_result_val, some_result_test分别存了预测结果。  
>
> 然后就是看代码了，后面再看吧。
>
> 发现问题了，见 12.4 part 1。

周五下午两点半，已经不想学了。验证上面那一点竟然弄了四个小时。  
我竟然连菜都忘了收？  
一来就验证数据去了。

# 2023.12.4 周一
## 1、QCNet代码test部分找到问题所在了
> 首先是看test数据集，因为不存在未来数据，看是否对训练过程有影响  
> 道路编码，以AV为中心，考虑半径怎么才100？  
> 果然，解码的时候用到了'predict_mask'，我看这一步的备注是“只有存在未来步才预测”，好家伙。  
> 把预处理的部分改了一下，再跑一遍试试。【重大进步】  
> FDE 1.20，我总算是，四个月，总算是找到问题所在了。  
> 然后这个数据我是拿QCNet的原始超参数进行的test，与训练过程的test不同，后面我要进行多次实验。

- [ ] 超参数调整，test过程的超参数设置对结果的影响如何。
> QCNet原始超参数，version_16，epoch_54，FDE 1.20，bFDE：1.899  
> 新参数，version_16，epoch_54  
> 
> QCNet原始超参数，version_1，epoch_43，FDE 1.22，bFDE：1.915  
> 新参数，version_1，epoch_43
> 在MEC上处理。

## 2、写场景介绍，画场景图。
> 打算看看论文，看不下去。  
> 打打游戏缓缓。   

> 结果拉着开会，要写场景的文档。  
> 写差不多了，晚上又得开会  
> 讨论场景为交叉路口，场景参与方有若干行人与车辆；车辆在机动车道上行驶，行人在人行横道上行走。路测端传感器实时识别追踪并记录下场景中各个参与者的位置，作为轨迹预测模块使用的历史轨迹。轨迹预测模块基于场景中所有参与者的历史轨迹，结合场景地图数据，进行预测时长为5秒的多模态预测。碰撞风险评估模块基于多模态未来轨迹，评判场景中各参与者的碰撞风险。对碰撞风险过高的场景参与者进行预警，如行人通过APP得到预警，使其注意周边车辆。  
> 图的话，可以用一个在线画图网站：  
> https://products.aspose.app/diagram/zh-cn/editor  

> 代码终于可以跑啦，轻松多了。  
> 发现QCNet初始数据可以以batch_size 16跑，可以，理论上四天多就可以跑完。  

# 2023.12.5 周二
## 1、QCNet 实验
> 跑实验，占用率太高了只剩二十几兆。  
> 玩了会MEC，准备把代码备份一下。  
> 把所有的结果都放到q1里面去了，减小q3的大小。  
> 把数据备份到U盘了，然后拷了一份到MEC上，给MEC装上QCNet的环境。  
> 现在正在跑的代码大概1.5h一个epoch，4天跑完，这4天把已有的模型测一下。  
> 每次配环境的时候，需要把map_file移到环境文件夹下，今天发现原来是初始化am时没有指定文件夹。  

> 新建了q7，用来实现经过几个月沉淀的方案。  
> 首先把代码整理了一下，主要删除了一些用于av1与av2兼容的代码，主要是head。  
> 

## 2、Risk Assessment方法
> [碰撞评估综述](/note/Risk%20Assessment/node/Risk_Assessment_Methodologies_for_Autonomous_Driving_A_Survey.md)
> 